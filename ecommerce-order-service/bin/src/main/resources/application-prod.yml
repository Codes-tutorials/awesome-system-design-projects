# Production Configuration
server:
  port: 8080
  tomcat:
    threads:
      max: 500
      min-spare: 50
    connection-timeout: 20000
    max-connections: 20000
    accept-count: 200

spring:
  # Database Configuration - Production
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:order_db}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    hikari:
      maximum-pool-size: 100
      minimum-idle: 20
      connection-timeout: 20000
      idle-timeout: 300000
      max-lifetime: 1200000
      leak-detection-threshold: 60000

  # JPA Configuration - Production
  jpa:
    hibernate:
      ddl-auto: none
    show-sql: false
    properties:
      hibernate:
        jdbc:
          batch_size: 100
          fetch_size: 200
        generate_statistics: false

  # Redis Configuration - Production
  data:
    redis:
      cluster:
        nodes: ${REDIS_CLUSTER_NODES}
      password: ${REDIS_PASSWORD}
      timeout: 1000ms
      lettuce:
        pool:
          max-active: 100
          max-idle: 50
          min-idle: 20
          max-wait: 1000ms

  # Kafka Configuration - Production
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS}
    producer:
      batch-size: 65536
      linger-ms: 10
      buffer-memory: 134217728
      compression-type: lz4
    consumer:
      properties:
        max.poll.records: 500
        session.timeout.ms: 30000
        heartbeat.interval.ms: 10000

# Production Order Configuration
order:
  flash-sale:
    max-orders-per-second: 50000
    queue-size: 500000
    processing-threads: 100
    
  rate-limit:
    orders-per-user-per-minute: 20
    orders-per-user-per-hour: 200
    global-orders-per-second: 100000
    
  processing:
    batch-size: 500
    batch-timeout: 500ms
    
  sharding:
    shard-count: 64

# External Services - Production
external-services:
  inventory-service:
    base-url: ${INVENTORY_SERVICE_URL}
    timeout: 1000ms
    max-connections: 200
    
  payment-service:
    base-url: ${PAYMENT_SERVICE_URL}
    timeout: 3000ms
    max-connections: 100
    
  user-service:
    base-url: ${USER_SERVICE_URL}
    timeout: 500ms
    max-connections: 200

# Production Logging
logging:
  level:
    com.ecommerce.order: INFO
    org.springframework: WARN
    org.hibernate: WARN
    org.apache.kafka: WARN
  file:
    name: /var/log/order-service/application.log
  logback:
    rollingpolicy:
      max-file-size: 100MB
      max-history: 30